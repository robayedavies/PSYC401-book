<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Psychological data analysis for graduate students: PSYC401 - 6&nbsp; Developing the linear model</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./report-preface.html" rel="next">
<link href="./lm-intro.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./lm-dev.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Developing the linear model</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Psychological data analysis for graduate students: <em>PSYC401</em></a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface: Our approach</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">DATA ANALYSIS</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypotheses-associations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hypotheses and associations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Introduction to visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data visualization</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to the linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lm-dev.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Developing the linear model</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">THE RESEARCH REPORT ASSIGNMENT</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./report-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The research report assignment: Outline introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Reasons why we do the research report assignment: What you will learn</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./what.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">What you have to do</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./how.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">How you can do it</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">MAKING THE MOST OF R</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./knowledge-ecosystem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">The R knowledge ecosystem and how to help yourself</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">END</span></span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-lm-dev-overview" id="toc-sec-lm-dev-overview" class="nav-link active" data-scroll-target="#sec-lm-dev-overview"><span class="header-section-number">6.1</span> Overview</a></li>
  <li><a href="#sec-lm-dev-goals" id="toc-sec-lm-dev-goals" class="nav-link" data-scroll-target="#sec-lm-dev-goals"><span class="header-section-number">6.2</span> Our learning goals</a>
  <ul class="collapse">
  <li><a href="#using-the-linear-model-to-answer-research-questions" id="toc-using-the-linear-model-to-answer-research-questions" class="nav-link" data-scroll-target="#using-the-linear-model-to-answer-research-questions"><span class="header-section-number">6.2.1</span> Using the linear model to answer research questions</a></li>
  </ul></li>
  <li><a href="#sec-lm-dev-resources" id="toc-sec-lm-dev-resources" class="nav-link" data-scroll-target="#sec-lm-dev-resources"><span class="header-section-number">6.3</span> Learning resources</a>
  <ul class="collapse">
  <li><a href="#sec-lm-dev-lectures" id="toc-sec-lm-dev-lectures" class="nav-link" data-scroll-target="#sec-lm-dev-lectures"><span class="header-section-number">6.3.1</span> Lectures</a></li>
  <li><a href="#sec-lm-dev-practical" id="toc-sec-lm-dev-practical" class="nav-link" data-scroll-target="#sec-lm-dev-practical"><span class="header-section-number">6.3.2</span> Practical materials</a></li>
  <li><a href="#sec-lm-dev-practical-workbook" id="toc-sec-lm-dev-practical-workbook" class="nav-link" data-scroll-target="#sec-lm-dev-practical-workbook"><span class="header-section-number">6.3.3</span> The workbook</a></li>
  <li><a href="#the-data-files" id="toc-the-data-files" class="nav-link" data-scroll-target="#the-data-files"><span class="header-section-number">6.3.4</span> The data files</a></li>
  <li><a href="#the-answers" id="toc-the-answers" class="nav-link" data-scroll-target="#the-answers"><span class="header-section-number">6.3.5</span> The answers</a></li>
  </ul></li>
  <li><a href="#sec-lm-dev-notes" id="toc-sec-lm-dev-notes" class="nav-link" data-scroll-target="#sec-lm-dev-notes"><span class="header-section-number">6.4</span> Lecture notes</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-lm-dev-intro" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Developing the linear model</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Under construction</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(faux)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
************
Welcome to faux. For support and examples visit:
https://debruine.github.io/faux/
- Get and set global package options with: faux_options()
************</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggcorrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggcorrplot' was built under R version 4.1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggeffects)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggExtra' was built under R version 4.1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggridges)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ggridges' was built under R version 4.1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at /Users/robdavies/OneDrive - Lancaster University/FromBox/teaching-PSYC401-402/PSYC401-book</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ordinal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'ordinal' was built under R version 4.1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'patchwork' was built under R version 4.1.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyr' was built under R version 4.1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'purrr' was built under R version 4.1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'stringr' was built under R version 4.1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ lubridate 1.9.2     ✔ tibble    3.2.1
✔ purrr     1.0.1     ✔ tidyr     1.3.0</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::combine() masks gridExtra::combine()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ dplyr::slice()   masks ordinal::slice()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -- code to read in the currently collated student project datasets</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -- see:</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># teaching-PSYC122-PYC401-402-notes_2022-07-22.rtf</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2022-12-05 notes</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co"># -- where see:</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2022-07-27_all-studies.csv</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2022-07-27_all-studies-subject-scores.csv</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="co"># /Users/robdavies/OneDrive - Lancaster University/FromBox/project health comprehension/PSYC400 2021-22 study/data-analysis</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="co"># -- which comprises the PSYC122, PSYC304, PSYC401 datasets:</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co"># PSYC122-2021-22_2022-05-13.csv</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># PSYC304-2021-22_2022-05-13.csv</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># PSYC401-2021-22_2022-05-13.csv  </span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># -- plus:</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 2022-07-27_KA-prog-noNAs-tidy.csv</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 2022-07-27_KA-prog-noNAs-tidy.csv</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>all.studies <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"2022-07-27_all-studies.csv"</span>, </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ResponseId =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">study =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">EDUCATION =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">GENDER =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ETHNICITY =</span> <span class="fu">col_factor</span>()</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                                    )</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="co"># -- code to read in the aggregated subject level data from the combined dataset</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>all.studies.subjects <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"2022-07-27_all-studies-subject-scores.csv"</span>, </span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">col_types =</span> <span class="fu">cols</span>(</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ResponseId =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">study =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">EDUCATION =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">GENDER =</span> <span class="fu">col_factor</span>(),</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">ETHNICITY =</span> <span class="fu">col_factor</span>()</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>                                    )</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>                                   )</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="co"># -- need to calculate and add mean.acc to all.studies.subjects</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>all.studies.subjects <span class="ot">&lt;-</span> all.studies <span class="sc">%&gt;%</span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ResponseId) <span class="sc">%&gt;%</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean.acc =</span> <span class="fu">mean</span>(response), <span class="at">mean.self =</span> <span class="fu">mean</span>(rating)) <span class="sc">%&gt;%</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(all.studies.subjects)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ResponseId)`</code></pre>
</div>
</div>
<section id="sec-lm-dev-overview" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sec-lm-dev-overview"><span class="header-section-number">6.1</span> Overview</h2>
<p>Welcome to our overview of the materials you will work with in our class introducing you to the <strong>linear model</strong> in <em>PSYC401</em> Week 9.</p>
<p>We will return to locate our learning in the context of the <em>Clearly understood</em> project. We will present our PSYC401 lessons in the context of this research project because we think that this context will help you to make sense of the data (as we explain in <a href="index.html"><span>Chapter&nbsp;1</span></a>).</p>
<p>Remember: it is unclear how to make health communication more effective. The problem is that we are not sure how health information should be communicated so that everyone can understand it. This is why we ask the research questions:</p>
<ol type="1">
<li>What person attributes predict success in understanding?</li>
<li>Can people accurately evaluate whether they correctly understand written health information?</li>
</ol>
<p>As we work together, we will be revisiting some of the ideas and techniques you have seen in previous classes. This is to give you the opportunity to consolidate your learning. We will be extending your development with some new ideas to strengthen your skills.</p>
<p>You can read a bit more about the project and the project data in <a href="hypotheses-associations.html"><span>Chapter&nbsp;1</span></a>.</p>
</section>
<section id="sec-lm-dev-goals" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sec-lm-dev-goals"><span class="header-section-number">6.2</span> Our learning goals</h2>
<p>This week, we focus on learning how to predict people: predicting observations about us (e.g., our attributes) or about the things we make or do. To do this, we will learn to think about and work with <em>linear models</em>.</p>
<p><strong>Our learning objectives: — what are we learning about?</strong></p>
<section id="using-the-linear-model-to-answer-research-questions" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="using-the-linear-model-to-answer-research-questions"><span class="header-section-number">6.2.1</span> Using the linear model to answer research questions</h3>
<ul>
<li>We will learn how to:</li>
</ul>
<ol type="1">
<li>code linear models</li>
<li>identify and interpret model statistics</li>
<li>critically evaluate the results</li>
<li>communicate the results</li>
</ol>
<ul>
<li>Because we often want to know about relationships, asking questions like:</li>
</ul>
<ol type="1">
<li>Does variation in X predict variation in Y?</li>
<li>What are the factors that influence outcome Y?</li>
<li>Is a theoretical model consistent with observed behaviour?</li>
</ol>
</section>
</section>
<section id="sec-lm-dev-resources" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="sec-lm-dev-resources"><span class="header-section-number">6.3</span> Learning resources</h2>
<p>You will see in the <em>next section</em> links to the lectures we created both to explain the concepts we want to help you to learn about, and to explain the practical data analysis skills we want to help you to develop (<a href="#sec-lm-dev-lectures"><span>Section&nbsp;6.3.1</span></a>). We <em>then</em> share links to information about the practical materials we have provided to help you to practise those skills (<a href="#sec-lm-dev-practical"><span>Section&nbsp;6.3.2</span></a>).</p>
<p>All the links to the lecture videos, the lecture slides, and everything you need for your practical work can <em>also</em> be found in the Week 9 files folder on Moodle <a href="https://modules.lancaster.ac.uk/course/view.php?id=40622#coursecontentcollapse10" target="_blank">here</a></p>
<p>In <a href="#sec-lm-dev-notes"><span>Section&nbsp;6.4</span></a>, we present the lecture slide points.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Linked resources</strong> include:</p>
<ul>
<li>In <a href="hypotheses-associations.html"><span>Chapter&nbsp;1</span></a>, we present an overview of the materials we have shared to support your development of critical thinking in relation to associations, and to support your learning about conducting correlation-based analyses of associations.</li>
<li>It may help you to revise these materials.</li>
</ul>
</div>
</div>
<section id="sec-lm-dev-lectures" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="sec-lm-dev-lectures"><span class="header-section-number">6.3.1</span> Lectures</h3>
<p>The lecture material for this week is presented in four short parts. Click on a link and your browser should open a tab showing the <em>Panopto</em> video for the lecture part.</p>
<p><a href="https://lancaster.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=9d4653c0-9ea2-4437-a74f-af5f00b2fd2e" target="_blank">Part 1 of 4</a></p>
<p><a href="https://lancaster.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=71eaffe1-5066-425c-9ce2-af5f00b79730" target="_blank">Part 2 of 4</a></p>
<p><a href="https://lancaster.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=a08f12af-606a-4be0-90ae-af5f00bc1491" target="_blank">Part 3 of 4</a></p>
<p><a href="https://lancaster.cloud.panopto.eu/Panopto/Pages/Viewer.aspx?id=a16c627e-609b-49db-b683-af5f00bfb15f" target="_blank">Part 4 of 4</a></p>
<p>You can download the slides we presented in the lecture in two different formats, depending on what you think will be most useful to you:</p>
<ul>
<li>Download the slides exactly as they appear in the lecture from <a href="files/401-linear-model-intro.html">this link</a>. The .html file can be opened and viewed in any web browser (e.g., Chrome, Firefox, Safari).</li>
<li>Or you can download a printable Word .docx presentation of the slides from <a href="files/401-linear-model-intro-printable-edit.docx">this link</a>. The .docx can be opened in Microsoft Word. The figures will not appear exactly as they do in the lecture recording because Word cannot cope with images so well but the trade-off is that you get a document you can print and edit to add notes.</li>
</ul>
</section>
<section id="sec-lm-dev-practical" class="level3" data-number="6.3.2">
<h3 data-number="6.3.2" class="anchored" data-anchor-id="sec-lm-dev-practical"><span class="header-section-number">6.3.2</span> Practical materials</h3>
<p>We have collected the practical materials together into a folder.</p>
<p>The folder includes the data files:</p>
<ul>
<li><code>study-one-general-participants.csv</code></li>
<li><code>study-two-general-participants.csv</code></li>
</ul>
<p>and .R code files:</p>
<ul>
<li><code>401-lm-intro-how-to.R</code></li>
<li><code>401-lm-intro-workbook.R</code></li>
</ul>
<p>You will use these files for your practical learning.</p>
<p>You can download the .R files and the data .csv files in a single folder, using the link <a href="files/PSYC401_lm-intro_materials.zip">here</a>.</p>
<p>Or you can download the files as individual files from the module <a href="https://modules.lancaster.ac.uk/course/view.php?id=40622#coursecontentcollapse10" target="_blank">Moodle page for PSYC401</a>.</p>
<p>Once you have downloaded the file folder, you will need to upload it to the R-Studio server to access and use the R files.</p>
<section id="sec-lm-dev-practical-how-to" class="level4" data-number="6.3.2.1">
<h4 data-number="6.3.2.1" class="anchored" data-anchor-id="sec-lm-dev-practical-how-to"><span class="header-section-number">6.3.2.1</span> The how-to guide</h4>
<p>In the <code>how-to</code> guide:</p>
<ul>
<li><code>401-lm-intro-how-to.R</code></li>
</ul>
<p>we show you how to do everything you need to do in the practical workbook (see <a href="#sec-lm-dev-practical-workbook"><span>Section&nbsp;6.3.3</span></a>). The guide comprises an .R file <code>401-lm-intro-how-to.R</code> with code and advice.</p>
<p>The code in the .R file was written to work with the data file</p>
<ul>
<li><code>study-one-general-participants.csv</code>.</li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>Work through the steps in the <code>how-to</code> guide first, this practice will help you to understand what you need to do for the <code>workbook</code> tasks.</p></li>
<li><p>The <code>how-to</code> guide and the <code>workbook</code> have similar structures. This is intentional: so that you can copy and <em>adapt</em> code from the <code>how-to</code> guide to do the practical tasks in the <code>workbook</code>.</p></li>
</ul>
</div>
</div>
</section>
</section>
<section id="sec-lm-dev-practical-workbook" class="level3" data-number="6.3.3">
<h3 data-number="6.3.3" class="anchored" data-anchor-id="sec-lm-dev-practical-workbook"><span class="header-section-number">6.3.3</span> The workbook</h3>
<p>In the <code>workbook</code>:</p>
<ul>
<li><code>401-lm-intro-workbook.R</code></li>
</ul>
<p>you will work with the data file</p>
<ul>
<li><code>study-two-general-participants.csv</code></li>
</ul>
<p>We split .R scripts into parts, tasks and questions.</p>
<p>For this class on linear models, our practical materials have two aims:</p>
<ol type="1">
<li>Helping you to learn how to use linear models to address questions about associations, questions like “What person attributes predict success in understanding?”;</li>
<li>Helping you to learn how to interpret linear model results, including how to work with data visualizations displaying distributions or associations.</li>
</ol>
<p>We progress a series of parts, each designed to enable learning or developing concepts or skills:</p>
<ul>
<li><strong>Part 3</strong> refreshes your development of skills for working with histogram-based visualizations of data distributions. Here, we are aiming to advance your skills so that you can develop nicer looking histograms that present more accurate accounts of distributions (by showing the full range of potential values), and so that you can annotate histograms to direct the attention of your audience <a href="visualization-intro.html">as we discuss in&nbsp;<span>3</span></a>.</li>
<li><strong>Part 4</strong> helps you to learn how you can present grids of histograms for easy comparison of variable distributions.</li>
<li><strong>Part 5</strong> refreshes your development of skills for working with scatterplot-based visualizations of associations or of the relationships between two or more numeric variables. We look at how you can edit the appearance of the plots, element by element. And we look at how you can produce grids of scatterplots, again, to enable comparisons — here, of the potential relationships between one outcome and multiple other variables.</li>
<li><strong>Part 6</strong> offers the opportunity to revise the calculation and interpretation of correlation analyses.</li>
<li><strong>Part 7</strong> provides exercises designed to help you to learn how to conduct linear model analyses.</li>
<li><strong>Part 8</strong> helps you to develop skills in calculating and presenting model predictions.</li>
<li><strong>Part 9</strong> is optional and focuses on working with R-community information to find out how to annotate plots using <code>geom_vline()</code> or <code>geom_hline()</code>.</li>
</ul>
<p>The activity <code>401-lm-intro-workbook.R</code> file takes you through the tasks, one by one.</p>
<p>If you are unsure about what you need to do, check the advice in <code>401-lm-intro-how-to.R</code>.</p>
<p>You will see that you can match a task in the <code>activity</code> to the same task in the <code>how-to</code>. The <code>how-to</code> shows you what function you need and how you should write the function code. You will need to change the names of the data-set or the variables to complete the tasks in the activity.</p>
</section>
<section id="the-data-files" class="level3" data-number="6.3.4">
<h3 data-number="6.3.4" class="anchored" data-anchor-id="the-data-files"><span class="header-section-number">6.3.4</span> The data files</h3>
<p>Each of the data files we will work with has a similar structure.</p>
<!-- Here are what the first few rows in the data file `study-two-general-participants.csv` looks like: -->
<!-- # ```{r head} -->
<!-- # #| warning: false -->
<!-- # #| echo: false -->
<!-- # kable(head(clearly.two.subjects)) -->
<!-- # ``` -->
<p>You can see the columns:</p>
<ul>
<li><code>participant_ID</code> participant code</li>
<li><code>mean.acc</code> average accuracy of response to questions testing understanding of health guidance</li>
<li><code>mean.self</code> average self-rated accuracy of understanding of health guidance</li>
<li><code>study</code> variable coding for what study the data were collected in</li>
<li><code>AGE</code> age in years</li>
<li><code>HLVA</code> health literacy test score</li>
<li><code>SHIPLEY</code> vocabulary knowledge test score</li>
<li><code>FACTOR3</code> reading strategy survey score</li>
<li><code>GENDER</code> gender code</li>
<li><code>EDUCATION</code> education level code</li>
<li><code>ETHNICITY</code> ethnicity (Office National Statistics categories) code</li>
</ul>
</section>
<section id="the-answers" class="level3" data-number="6.3.5">
<h3 data-number="6.3.5" class="anchored" data-anchor-id="the-answers"><span class="header-section-number">6.3.5</span> The answers</h3>
<p>After the practical class, you will be able to download the answers version of the <code>workbook</code> here.</p>
<!-- [401-visualization-workbook-answers.R](files/401-visualization-workbook-answers.R) -->
<p>The answers version will present my answers for questions, and some extra information where that is helpful.</p>
</section>
</section>
<section id="sec-lm-dev-notes" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="sec-lm-dev-notes"><span class="header-section-number">6.4</span> Lecture notes</h2>
<p>Some people find it easier to read notes than to watch video recordings. This is why we also include the lecture notes here.</p>
<!-- ::: callout-tip -->
<!-- In these notes, I provide notes on the code steps that result in plots. -->
<!-- -   Click on the `Notes` tab to see them. -->
<!-- ::: -->
<!-- ## Analyze + visualize + present -->
<!-- ```{dot} -->
<!-- //| label: fig-pipeline -->
<!-- //| fig-cap: "The data analysis pipeline or workflow: we focus on the linear model" -->
<!-- //| fig-alt: "The diagram shows a flowchart. The flowchart starts at the top with 'get raw data' and finishes at the bottom with 'present'. 'get raw data' has an arrow to 'tidy data'. 'tidy data' has arrows to 'analyze', 'explore' and 'visualize'. On the same level as 'tidy 'data', 'assumptions' also has arrows to 'analyze', 'explore' and 'visualize'. Then 'analyze', 'explore' and 'visualize' have arrows to 'present'. The 'analyze', 'visualize' and 'present' boxes are outlined in red." -->
<!-- digraph Q { -->
<!--   node [shape=record]; -->
<!--   nd_1   [label = "Get raw data"]; -->
<!--   nd_2   [label = "Tidy data"]; -->
<!--   nd_3_a [label = "Assumptions"]; -->
<!--   nd_3_l [label = "Visualize", color = red]; -->
<!--   nd_3   [label = "Analyze", color = red]; -->
<!--   nd_3_r [label = "Explore"]; -->
<!--   nd_4   [label = "Present", color = red]; -->
<!--   nd_3_a -> nd_3 [color = grey]; -->
<!--   nd_3_a -> nd_3_r [color = grey]; -->
<!--   nd_3_a -> nd_3_l [color = grey]; -->
<!--   nd_2 -> nd_3_r [color = grey]; -->
<!--   nd_2 -> nd_3_l [color = grey]; -->
<!--   nd_1 -> nd_2 -> nd_3 -> nd_4 [color = grey]; -->
<!--   nd_3_l -> nd_4 [color = grey]; -->
<!--   subgraph cluster_R { -->
<!--     {rank=same nd_3_l nd_3 nd_3_r} -->
<!--     nd_3_l -> nd_3 -> nd_3_r [color= none arrowhead=none]; -->
<!--   } -->
<!-- } -->
<!-- ``` -->
<!-- ## Develop the linear model: our aims -->
<!-- -   We will learn how to: -->
<!-- 1.  Extend our capacity to code models so that we can incorporate **multiple predictors** -->
<!-- 2.  Develop the thought processes required to make **decisions about what predictors to include** -->
<!-- 3.  Develop the skills required to **critically evaluate results** -->
<!-- -   Especially considering potential variation across samples -->
<!-- ## Develop the linear model: our aims -->
<!-- -   We will revise how to: -->
<!-- 5.  Identify and interpret model statistics -->
<!-- 6.  Critically evaluate the results -->
<!-- 7.  Communicate the results -->
<!-- -   We will learn how to: explore **extensions** of the linear model -->
<!-- ## We close the loop: Our *context*, the health comprehension project -->
<!-- ::: columns -->
<!-- ::: {.column width=".4"} -->
<!-- 1.  Because public health impacts depend on giving people information they can understand -->
<!-- 2.  We want to know: **What makes it easy or difficult to understand written health information?** -->
<!-- ::: -->
<!-- ::: {.column width=".6"} -->
<!-- ```{r nurse-patient-talk-1, echo=FALSE, out.width='100%', fig.cap="flickr: Sasin Tipchair 'Senior woman in wheelchair talking to a nurse in a hospital'"} -->
<!-- knitr::include_graphics("nurse-patient-talk.png") -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: -->
<!-- ## We close the loop: Health comprehension project, questions and analyses -->
<!-- 1.  We want to know: **What makes it easy or difficult to understand written health information?** -->
<!-- 2.  So our research questions are: -->
<!-- -   What person attributes predict success in understanding? -->
<!-- -   Can people accurately evaluate whether they correctly understand written health information? -->
<!-- ## Extensions to the linear model: Multiple predictors -->
<!-- -   We need only a **limited change to R code** -->
<!-- -   To specify a model with **multiple predictors** -->
<!-- ## How we *estimate* the association between two variables: One outcome and one predictor -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| eval: false -->
<!-- #| code-line-numbers: "1|2|3" -->
<!-- model <- lm(mean.acc ~ SHIPLEY,  -->
<!--             data = all.studies.subjects) -->
<!-- summary(model) -->
<!-- ``` -->
<!-- 1.  Specify the `lm` function and the model `mean.acc ~ ...` -->
<!-- 2.  Specify what data we use `data = all.studies.subjects` -->
<!-- 3.  Get the results `summary(model)` -->
<!-- ## How we *estimate* the association between multiple variables: One outcome and *multiple* predictors -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| eval: false -->
<!-- #| code-line-numbers: "1|2|3" -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- summary(model) -->
<!-- ``` -->
<!-- 4.  Specify the `lm` function and the model: -->
<!-- -   `mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE` -->
<!-- ## The sentence structure of model code in R {background-color="lightblue"} -->
<!-- Take a good look: -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| eval: false -->
<!-- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE, ...) -->
<!-- ``` -->
<!-- You will see this sentence structure in coding for *many* different analysis types -->
<!-- -   `method(outcome ~ predictors)` -->
<!-- -   `predictors` could be `SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE ...` -->
<!-- ## Extensions to the linear model: Multiple predictors -->
<!-- -   We assume that the outcome prediction errors *residuals* are normally distributed -->
<!-- -   We do not assume that the distributions of *predictor variables* are normal -->
<!-- ## Revision: What differences between observed and predicted outcome values look like {.smaller} -->
<!-- ::: columns -->
<!-- ::: {.column width=".4"} -->
<!-- -   Differences between observed and predicted outcomes are shown by the vertical lines -- outcome prediction errors: **residuals** -->
<!-- -   Better models should show smaller differences between observed and predicted outcome values -->
<!-- ::: -->
<!-- ::: {.column width=".6"} -->
<!-- ```{r} -->
<!-- #| label: fig-abline-predict-residuals-1 -->
<!-- #| fig-cap: "The predicted change in mean comprehension accuracy, given variation in vocabulary scores. Observed values are shown in orange-red. Predicted values are shown in blue" -->
<!-- #| fig-alt: "The figure presents a scatterplot indicating the association between variables mean accuracy (on y-axis) and vocabulary (x-axis) scores. The points are shown in different shades of orange to red, and clustered such that higher vocabulary scores tend to be associated with higher accuracy scores. The predicted trend is indicated by a thick blue line. Predicted outcomes, given different sample values of vocabulary are circled in black along the blue line. Light grey lines indicate the difference between predicted and observed outcomes. The observed points are darker red the further they are from the prediction." -->
<!-- #| fig-height: 5 -->
<!-- #| fig-width: 5 -->
<!-- #| fig-align: center -->
<!-- # -- plot residuals against predicted values -->
<!-- # https://drsimonj.svbtle.com/visualising-residuals -->
<!-- # clearly.one.subjects -->
<!-- fit <- lm(mean.acc ~ SHIPLEY, data = clearly.one.subjects) -->
<!-- # -- then -->
<!-- clearly.one.subjects$predicted <- predict(fit)   # Save the predicted values -->
<!-- clearly.one.subjects$residuals <- residuals(fit) # Save the residual values -->
<!-- # -- plot observed vs. predicted values -->
<!-- ggplot(clearly.one.subjects, aes(x = SHIPLEY, y = mean.acc)) + -->
<!--   geom_smooth(method = "lm", se = FALSE, colour = "lightblue") +  # Plot regression slope -->
<!--   geom_segment(aes(xend = SHIPLEY, yend = predicted), alpha = .25) +  # alpha to fade lines -->
<!--   # > Color adjustments made here... -->
<!--   geom_point(aes(color = abs(residuals))) + # Color mapped to abs(residuals) -->
<!--   scale_color_continuous(low = "orange", high = "darkred") +  # Colors to use here -->
<!--   guides(color = FALSE) +  # Color legend removed -->
<!--   geom_point(aes(y = predicted), shape = 1) + -->
<!--   theme_bw() + -->
<!--   ylim(0,1.1) + xlim(20,40) + -->
<!--   xlab("Vocabulary (Shipley)") + ylab("Mean accuracy") -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: -->
<!-- ## Revision: We typically assume that the residuals are normally distributed -->
<!-- ::: columns -->
<!-- ::: {.column width=".4"} -->
<!-- -   Some outcome prediction errors -- **residuals** -- are positive -->
<!-- -   Some residuals are negative -->
<!-- -   The average of the residuals will be zero overall -->
<!-- ::: -->
<!-- ::: {.column width=".6"} -->
<!-- ```{r} -->
<!-- #| label: fig-residuals-density-1 -->
<!-- #| fig-cap: "Plot showing the distribution of prediction errors -- residuals -- for the linear model of comprehension accuracy" -->
<!-- #| fig-alt: "The figure a histogram of the residuals, the prediction errors, for the linear model of the association between mean comprehension accuracy and vocabulary. The histogram is shown in grey, and the peak is centered at residuals = 0. A dashed red line is drawn at resdiduals = 0. A red density curve is superimposed on the histogram to indicate the theoretical normal distribution of residuals." -->
<!-- #| fig-height: 4 -->
<!-- #| fig-width: 4 -->
<!-- #| fig-align: center -->
<!-- # -- plot residuals vs. theoretical normal -->
<!-- # https://stackoverflow.com/questions/6967664/ggplot2-histogram-with-normal-curve -->
<!-- ggplot(clearly.one.subjects, aes(x = residuals)) + -->
<!--   geom_histogram(aes(y = ..density..), alpha = .75, binwidth = .1) + -->
<!--   stat_function(fun = dnorm, args = -->
<!--                   list(mean = mean(clearly.one.subjects$residuals),  -->
<!--                        sd = sd(clearly.one.subjects$residuals)), -->
<!--                 colour = "red", size = 1.5) + -->
<!--   geom_vline(xintercept = 0, linetype = "dashed", colour = "darkred", size = 1.1, alpha = .75) + -->
<!--   xlim(-.5, .5) + -->
<!--   theme_bw() -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: -->
<!-- ## Multiple candidate predictor variables -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| echo: false -->
<!-- #| label: fig-scatterplot-grid -->
<!-- #| fig-cap: "Scatterplot showing the potential association between accuracy of comprehension and variation on each of a series of potential predictor variables. Data from 8 studies" -->
<!-- #| fig-alt: "The figure presents a grid of scatterplots indicating the association between outcome mean accuracy (on y-axis) and (x-axis) scores on a range of predictor variables. The points are shown in grey, and higher points are associated with higher accuracy scores. The grid includes as predictors: self-rated accuracy; vocabulary (SHIPLEY); health literacy (HLVA); reading strategy (FACTOR3); age (years); gender; education, and ethnicity. The plots indicate that mean accuracy increases with increasing self-rated accuracy, vocabulary, health literacy, and reading strategy scores. Trends are indicated by red lines." -->
<!-- #| fig-width: 20 -->
<!-- #| fig-height: 10 -->
<!-- p.self <- all.studies.subjects %>% -->
<!--   ggplot(aes(x = mean.self, y = mean.acc)) + -->
<!--   geom_point(alpha = .35, colour = "darkgrey") + -->
<!--   geom_smooth(size = 1.5, colour = "red", method = "lm", se = FALSE) + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Mean self-rated accuracy") + ylab("Mean accuracy") -->
<!-- p.SHIPLEY <- all.studies.subjects %>% -->
<!--   ggplot(aes(x = SHIPLEY, y = mean.acc)) + -->
<!--   geom_point(alpha = .35, colour = "darkgrey") + -->
<!--   geom_smooth(size = 1.5, colour = "red", method = "lm", se = FALSE) + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Vocabulary (Shipley)") + ylab("Mean accuracy") -->
<!-- p.HLVA <- all.studies.subjects %>% -->
<!--   ggplot(aes(x = HLVA, y = mean.acc)) + -->
<!--   geom_point(alpha = .35, colour = "darkgrey") + -->
<!--   geom_smooth(size = 1.5, colour = "red", method = "lm", se = FALSE) + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Health literacy (HLVA)") + ylab("Mean accuracy") -->
<!-- p.FACTOR3 <- all.studies.subjects %>% -->
<!--   ggplot(aes(x = FACTOR3, y = mean.acc)) + -->
<!--   geom_point(alpha = .35, colour = "darkgrey") + -->
<!--   geom_smooth(size = 1.5, colour = "red", method = "lm", se = FALSE) + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Reading strategy (FACTOR3)") + ylab("Mean accuracy") -->
<!-- p.AGE <- all.studies.subjects %>% -->
<!--   ggplot(aes(x = AGE, y = mean.acc)) + -->
<!--   geom_point(alpha = .35, colour = "darkgrey") + -->
<!--   geom_smooth(size = 1.5, colour = "red", method = "lm", se = FALSE) + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Age (years)") + ylab("Mean accuracy") -->
<!-- p.GENDER <- all.studies.subjects %>% -->
<!--   mutate(GENDER = fct_recode(GENDER,  -->
<!--             "Prefer-not-to-say" = "prefer-not-to-say"                  -->
<!--                              )) %>% -->
<!--   ggplot(aes(x = GENDER, y = mean.acc)) + -->
<!--   geom_jitter(alpha = .35, colour = "darkgrey") + -->
<!--   geom_boxplot(outlier.shape = NA, colour = "red", alpha = .1) +  -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Gender") + ylab("Mean accuracy") -->
<!-- p.EDUCATION <- all.studies.subjects %>% -->
<!--   ggplot(aes(x = EDUCATION, y = mean.acc)) + -->
<!--   geom_jitter(alpha = .35, colour = "darkgrey") + -->
<!--   geom_boxplot(outlier.shape = NA, colour = "red", alpha = .1) +  -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Education") + ylab("Mean accuracy") -->
<!-- p.ETHNICITY <- all.studies.subjects %>% -->
<!--   ggplot(aes(x = ETHNICITY, y = mean.acc)) + -->
<!--   geom_jitter(alpha = .35, colour = "darkgrey") + -->
<!--   geom_boxplot(outlier.shape = NA, colour = "red", alpha = .1) +  -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Ethnicity") + ylab("Mean accuracy") -->
<!-- p.self + p.SHIPLEY + p.HLVA + p.FACTOR3 + p.AGE + p.GENDER + p.EDUCATION + p.ETHNICITY +  -->
<!--   plot_layout(ncol = 4) -->
<!-- ``` -->
<!-- ## We do not assume normal *predictors* -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| echo: false -->
<!-- #| label: fig-histogram-grid-1 -->
<!-- #| fig-cap: "Grid of plots showing the distribution of potential predictor variables. Data from 8 studies" -->
<!-- #| fig-alt: "The figure presents a grid of histograms indicating the distribution of (x-axis) scores on a range of predictor variables. The grid includes as predictors: self-rated accuracy; vocabulary (SHIPLEY); health literacy (HLVA); reading strategy (FACTOR3); age (years); gender; education, and ethnicity. The plots indicate: (1.) most self-rated accuracy scores are high (over 6); (2.) many participants with vocabulary scores greater than 30, a few with lower scores; (3.) health literacy scores centered on 8 or some, with lower and higher scores; (4.) a skewed distribution of reading strategy scores, with many around 20-40, and a tail of higher scores; (5.) most participants are 20-40 years of age, some older; (6.) many more female than male participants, very few non-binary reported; (7.) many more participants with higher education than further, very few with secondary; and (8.) many White participants (ONS categories), far fewer Asian or Mixed or Black ethnicity participants." -->
<!-- #| fig-width: 14 -->
<!-- #| fig-height: 7.5 -->
<!-- p.self <- ggplot(data = all.studies.subjects, aes(x = mean.self)) +  -->
<!--   geom_histogram(binwidth = 1) + -->
<!--   theme_bw() + -->
<!--   labs(x = "Self-rated accuracy", y = "frequency count")    -->
<!-- p.shipley <- ggplot(data = all.studies.subjects, aes(x = SHIPLEY)) +  -->
<!--   geom_histogram(binwidth = 2) + -->
<!--   theme_bw() + -->
<!--   labs(x = "Vocabulary (SHIPLEY)", y = "frequency count")    -->
<!-- p.HLVA <- ggplot(data = all.studies.subjects, aes(x = HLVA)) +  -->
<!--   geom_histogram(binwidth = 2) + -->
<!--   theme_bw() + -->
<!--   labs(x = "HLVA", y = "frequency count")  -->
<!-- p.FACTOR3 <- ggplot(data = all.studies.subjects, aes(x = AGE)) +  -->
<!--   geom_histogram(binwidth = 5) + -->
<!--   theme_bw() + -->
<!--   labs(x = "Reading strategy (FACTOR3)", y = "frequency count")  -->
<!-- p.age <- ggplot(data = all.studies.subjects, aes(x = AGE)) +  -->
<!--   geom_histogram(binwidth = 5) + -->
<!--   theme_bw() + -->
<!--   labs(x = "Age (years)", y = "frequency count")  -->
<!-- p.GENDER <- all.studies.subjects %>% -->
<!--   mutate(GENDER = fct_recode(GENDER,  -->
<!--             "Prefer-not-to-say" = "prefer-not-to-say"                  -->
<!--                              )) %>% -->
<!--   group_by(GENDER) %>% -->
<!--   summarise(count = n()) %>% -->
<!--   ungroup() %>% -->
<!--   mutate(GENDER = fct_reorder(GENDER, count)) %>% -->
<!--   ggplot(aes(y = GENDER, x = count)) + -->
<!--   geom_point(size = 3, aes(colour = GENDER)) + -->
<!--   theme_bw() +  -->
<!--   labs(y = "Gender", x = "frequency count")  -->
<!-- p.EDUCATION <- all.studies.subjects %>% -->
<!--   group_by(EDUCATION) %>% -->
<!--   summarise(count = n()) %>% -->
<!--   ungroup() %>% -->
<!--   mutate(EDUCATION = fct_reorder(EDUCATION, count)) %>% -->
<!--   ggplot(aes(y = EDUCATION, x = count)) + -->
<!--   geom_point(size = 3, aes(colour = EDUCATION)) + -->
<!--   theme_bw() +  -->
<!--   labs(y = "Education", x = "frequency count")  -->
<!-- p.ETHNICITY <- all.studies.subjects %>% -->
<!--   group_by(ETHNICITY) %>% -->
<!--   summarise(count = n()) %>% -->
<!--   ungroup() %>% -->
<!--   mutate(ETHNICITY = fct_reorder(ETHNICITY, count)) %>% -->
<!--   ggplot(aes(y = ETHNICITY, x = count)) + -->
<!--   geom_point(size = 3, aes(colour = ETHNICITY)) + -->
<!--   theme_bw() +  -->
<!--   labs(y = "Education", x = "frequency count") -->
<!-- p.self + p.shipley + p.HLVA + p.FACTOR3 + p.age + p.GENDER + p.EDUCATION + p.ETHNICITY +  -->
<!--   plot_layout(ncol = 3) -->
<!-- ``` -->
<!-- ## Extensions to the linear model: Multiple predictors -->
<!-- ::: callout-tip -->
<!-- We can try to model *anything* using linear models: that is the **real challenge we face** -->
<!-- -   Any analysis you have learned can instead be done using a linear model: ANOVA, t-test, correlation, $\chi^2$ test, ... -->
<!-- -   We can work with any kind of dependent or independent variable you can think of -->
<!-- **This is why we need to be careful** -->
<!-- ::: -->
<!-- ## Analyses are done in context so when we conduct analyses we *must* use contextual information -->
<!-- **Closing the loop: The health comprehension project questions** -->
<!-- ::: nonincremental -->
<!-- 1.  We want to know: *What makes it easy or difficult to understand written health information?* -->
<!-- 2.  So our research questions include: -->
<!-- -   What person attributes predict success in understanding? -->
<!-- ::: -->
<!-- ## We *must* use contextual information: theory of comprehension -->
<!-- ```{dot} -->
<!-- //| label: fig-comprehension-drivers-1 -->
<!-- //| fig-cap: "Understanding text depends on (1.) language experience and (2.) reasoning ability [@freed2017]" -->
<!-- //| fig-alt: "The diagram shows a flowchart, from left to right, nodes 'Language experience' and 'Reasoning capacity' are both connected by arrows to 'Comprehension outcome'."  -->
<!-- digraph Q { -->
<!--   rankdir="LR" -->
<!--   node [shape=box]; -->
<!--   node [style=rounded]; -->
<!--   nd_1_l   [label = "Language experience"]; -->
<!--   nd_1_r   [label = "Reasoning capacity"]; -->
<!--   nd_2   [label = "Comprehension outcome"]; -->
<!--   nd_1_l -> nd_2; -->
<!--   nd_1_r -> nd_2; -->
<!-- } -->
<!-- <!-- Freed et al., 2017; structural equation model, adult reading comprehension](freed-2017-fig1-sem-model-1.png){fig-alt="Freed et al., 2017; structural equation model, adult reading comprehension"} -->
<p>–&gt;</p>
<!-- ``` -->
<!-- ## Given theory, model of comprehension accuracy *should* include measures of -->
<!-- (1.) experience (HLVA, SHIPLEY) and (2.) reasoning ability (reading strategy) -->
<!-- ```{dot} -->
<!-- //| label: fig-comprehension-drivers-2 -->
<!-- //| fig-cap: "Understanding text depends on (1.) language experience and (2.) reasoning ability [@freed2017]" -->
<!-- //| fig-alt: "The diagram shows a flowchart, from left to right, nodes 'Language experience' and 'Reasoning capacity' are both connected by arrows to 'Comprehension outcome'."  -->
<!-- digraph Q { -->
<!--   rankdir="LR" -->
<!--   node [shape=box]; -->
<!--   node [style=rounded]; -->
<!--   nd_1_l   [label = "Language experience"]; -->
<!--   nd_1_r   [label = "Reasoning capacity"]; -->
<!--   nd_2   [label = "Comprehension outcome"]; -->
<!--   nd_1_l -> nd_2; -->
<!--   nd_1_r -> nd_2; -->
<!-- } -->
<!-- <!-- Freed et al., 2017; structural equation model, adult reading comprehension](freed-2017-fig1-sem-model-1.png){fig-alt="Freed et al., 2017; structural equation model, adult reading comprehension"} -->
<p>–&gt;</p>
<!-- ``` -->
<!-- ## The flexibility and power of linear models requires us to be aware of the *garden of forking paths* -->
<!-- ::: columns -->
<!-- ::: {.column width=".5"} -->
<!-- -   Which variables *should be included* in an analysis? -->
<!-- -   All of them; some of them; why? -->
<!-- -   Will others disagree with reason? -->
<!-- ::: -->
<!-- ::: {.column width=".5"} -->
<!-- ```{dot} -->
<!-- //| fig-width: 5 -->
<!-- //| label: fig-forking -->
<!-- //| fig-cap: Forking paths in data analysis -->
<!-- //| fig-alt: The diagram shows a hierarchy of nodes. At the top, node A has arrows down to nodes B1 and B2. Nodes B1 and B2 are on the same level. B1 has arrows to nodes C1, C2 and C3. B2 has arrows to nodes C4, C5 and C6.  -->
<!-- digraph D { -->
<!--   A -> {B1, B2} -->
<!--   B1 -> {C1, C2, C3} -->
<!--   B2 -> {C4, C5, C6} -->
<!-- } -->
<!-- ``` -->
<!-- ::: -->
<!-- ::: -->
<!-- ## Different researchers can reasonably make different choices -->
<!-- This is why we care about open science -->
<!-- -   Theory- and evidence-based selection of critical variables for analysis $\rightarrow$ *literature review* -->
<!-- -   Share usable data and analysis code in open repositories $\rightarrow$ *research report exercise*, PSYC403 data archiving -->
<!-- ## Let's take a break {background-color="aquamarine"} -->
<!-- ::: nonincremental -->
<!-- -   End of part 1 -->
<!-- ::: -->
<!-- ## Coding, thinking about, and reporting linear models with multiple predictors {background-color="lightblue"} -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| eval: false -->
<!-- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE, ...) -->
<!-- ``` -->
<!-- ## Coding the linear model with multiple predictors -->
<!-- ```{r} -->
<!-- #| echo: true -->
<!-- #| eval: false -->
<!-- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE, ...) -->
<!-- ``` -->
<!-- -   The code represents a linear model with multiple predictors: -->
<!-- -   $y = \beta_0 + \beta_1x_1 + \beta_2x_2 + \dots + \epsilon$ -->
<!-- ## Thinking about the linear model with multiple predictors -->
<!-- $y = \beta_0 + \beta_1x_1 + \beta_2x_2 + \dots + \epsilon$ -->
<!-- Outcome $y$ is calculated as the sum of: -->
<!-- -   The intercept $\beta_0$ plus -->
<!-- -   The product of the coefficient of the effect of e.g. `AGE` $\beta_1$ multiplied by $x_1$ a person's age `+` -->
<!-- -   `+` any number of other variables `+` -->
<!-- -   The error $\epsilon$: mismatches between observed and predicted outcomes -->
<!-- ## Identifying key information in results {.smaller} -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| label: fig-lm-output-summary-1 -->
<!-- #| fig-cap: "Output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors" -->
<!-- #| fig-alt: "The figure presents the output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors. The summary indicates significant positive effects of vocabulary, health literacy and reading strategy, and significant negative effects of age and native language (other). Overall, the model is significant, and eplains about 42% of outcome variance." -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- summary(model) -->
<!-- ``` -->
<!-- ## Identifying key information in results -->
<!-- 1.  The `summary()` of the linear model shows: -->
<!-- 2.  Estimates of the coefficients of the effects of the predictors we included, with null hypothesis significance tests of those estimates -->
<!-- 3.  Model fit statistics including `R-squared` and `F-statistic` estimates -->
<!-- ## For each predictor, e.g. HLVA, we see {.smaller} -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| label: fig-lm-output-summary-2 -->
<!-- #| fig-cap: "Output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors" -->
<!-- #| fig-alt: "The figure presents the output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors. The summary indicates significant positive effects of vocabulary, health literacy and reading strategy, and significant negative effects of age and native language (other). Overall, the model is significant, and eplains about 42% of outcome variance." -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- summary(model) -->
<!-- ``` -->
<!-- 1.  The Coefficient `Estimate`: `0.0242787` for the slope of the effect of variation in HLVA scores -->
<!-- 2.  The `Std. Error` (standard error) `0.0031769` for the estimate -->
<!-- 3.  The `t value` of `7.642` and associated `Pr(>|t|)` p-value `9.44e-14` for the null hypothesis test of the coefficient -->
<!-- ## Identifying the key information in the linear model results: Coefficients {.smaller} -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| label: fig-lm-output-summary-3 -->
<!-- #| fig-cap: "Output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors" -->
<!-- #| fig-alt: "The figure presents the output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors. The summary indicates significant positive effects of vocabulary, health literacy and reading strategy, and significant negative effects of age and native language (other). Overall, the model is significant, and eplains about 42% of outcome variance." -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- summary(model) -->
<!-- ``` -->
<!-- -   Pay attention to **sign and the size** of coefficient estimate: -->
<!-- -   Is the coefficient (e.g., HLVA `0.0242787`) a positive or a negative number? is it relatively large or small? -->
<!-- ## Identifying the key information in the linear model results: R-squared {.smaller} -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| label: fig-lm-output-summary-4 -->
<!-- #| fig-cap: "Output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors" -->
<!-- #| fig-alt: "The figure presents the output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors. The summary indicates significant positive effects of vocabulary, health literacy and reading strategy, and significant negative effects of age and native language (other). Overall, the model is significant, and eplains about 42% of outcome variance." -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- summary(model) -->
<!-- ``` -->
<!-- -   Revision: Pay attention to R-squared -->
<!-- -   R-squared indicates how much outcome variation we can predict, given our model -->
<!-- -   Revision: we report `Adjusted R-squared` because it tends to be more accurate -->
<!-- ## Identifying the key information in the linear model results: F {.smaller} -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- #| label: fig-lm-output-summary-5 -->
<!-- #| fig-cap: "Output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors" -->
<!-- #| fig-alt: "The figure presents the output summary for a linear model with mean accuracy of comprehension as the outcome and vocabulary (SHIPLEY), health literacy (HLVA), reading strategy (FACTOR3), age, and native language status as predictors. The summary indicates significant positive effects of vocabulary, health literacy and reading strategy, and significant negative effects of age and native language (other). Overall, the model is significant, and eplains about 42% of outcome variance." -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- summary(model) -->
<!-- ``` -->
<!-- -   The model summary gives us the F-statistic: -->
<!-- -   Revision: the F-test of the null hypothesis that the model *does not* predict the outcome -->
<!-- ## Plot predictions to interpret effects -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| label: fig-marginal-effects-plots-1 -->
<!-- #| fig-cap: "A grid of plots showing model predictions, for outcome accuracy, given variation in (a.) age, (b.) vocabulary, (c.) health literacy, (d) reading strategy and (e.) native language. Data from eight studies" -->
<!-- #| fig-alt: "The figure presents grid of plots showing model predictions, for outcome accuracy, given variation in (a.) age, (b.) vocabulary, (c.) health literacy, (d) reading strategy and (e.) native language. The plots are a series of scatterplots: raw data points are shown in grey; predicted outcome change, given variation on predictors, are indicated by a red line. The plots indicate that accuracy of comprehension is predicted to increase given increase in voccabulary, health literacy, and reading  strategy. Native speakers of English are predicted to show greater accuracy than speakers of English as another language. Older participants are predicted to show lower levels of accuracy." -->
<!-- #| fig-width: 10 -->
<!-- #| fig-height: 7 -->
<!-- # https://strengejacke.github.io/ggeffects/articles/introduction_plotmethod.html -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- dat <- ggpredict(model, terms = "AGE") -->
<!-- p.AGE <- plot(dat) -->
<!-- p.AGE <- p.AGE + -->
<!--   geom_point(data = all.studies.subjects,  -->
<!--              aes(x = AGE, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Age (years)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(a.)") -->
<!-- dat <- ggpredict(model, terms = "SHIPLEY") -->
<!-- p.SHIPLEY <- plot(dat) -->
<!-- p.SHIPLEY <- p.SHIPLEY + -->
<!--   geom_point(data = all.studies.subjects, -->
<!--              aes(x = SHIPLEY, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Vocabulary (Shipley)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(b.)") -->
<!-- dat <- ggpredict(model, terms = "HLVA") -->
<!-- p.HLVA <- plot(dat) -->
<!-- p.HLVA <- p.HLVA + -->
<!--   geom_point(data = all.studies.subjects, -->
<!--              aes(x = HLVA, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Health literacy (HLVA)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(c.)") -->
<!-- dat <- ggpredict(model, terms = "FACTOR3") -->
<!-- p.FACTOR3 <- plot(dat) -->
<!-- p.FACTOR3 <- p.FACTOR3 + -->
<!--   geom_point(data = all.studies.subjects, -->
<!--              aes(x = FACTOR3, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Reading strategy (FACTOR3)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(d.)") -->
<!-- dat <- ggpredict(model, terms = "NATIVE.LANGUAGE") -->
<!-- p.NATIVE.LANGUAGE <- plot(dat) -->
<!-- p.NATIVE.LANGUAGE <- p.NATIVE.LANGUAGE + -->
<!--   ylim(0, 1.1) + -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Native language") + ylab("Mean accuracy") + -->
<!--   ggtitle("(e.)") -->
<!-- p.AGE + p.SHIPLEY + p.HLVA + p.FACTOR3 + p.NATIVE.LANGUAGE + plot_layout(ncol = 3) -->
<!-- ``` -->
<!-- ## Compare estimates with effects plots {.smaller} -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| fig-alt: "The figure presents grid of plots showing model predictions, for outcome accuracy, given variation in (a.) age, (b.) vocabulary, (c.) health literacy, (d) reading strategy and (e.) native language. The plots are a series of scatterplots: raw data points are shown in grey; predicted outcome change, given variation on predictors, are indicated by a red line. The plots indicate that accuracy of comprehension is predicted to increase given increase in voccabulary, health literacy, and reading  strategy. Native speakers of English are predicted to show greater accuracy than speakers of English as another language. Older participants are predicted to show lower levels of accuracy." -->
<!-- #| #| fig-width: 10 -->
<!-- #| fig-height: 7 -->
<!-- #| fig-align: center -->
<!-- # https://strengejacke.github.io/ggeffects/articles/introduction_plotmethod.html -->
<!-- model <- lm(mean.acc ~ SHIPLEY + HLVA + FACTOR3 + AGE + NATIVE.LANGUAGE,  -->
<!--             data = all.studies.subjects) -->
<!-- dat <- ggpredict(model, terms = "AGE") -->
<!-- p.AGE <- plot(dat) -->
<!-- p.AGE <- p.AGE + -->
<!--   geom_point(data = all.studies.subjects,  -->
<!--              aes(x = AGE, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Age (years)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(a.)") -->
<!-- dat <- ggpredict(model, terms = "SHIPLEY") -->
<!-- p.SHIPLEY <- plot(dat) -->
<!-- p.SHIPLEY <- p.SHIPLEY + -->
<!--   geom_point(data = all.studies.subjects, -->
<!--              aes(x = SHIPLEY, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Vocabulary (Shipley)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(b.)") -->
<!-- dat <- ggpredict(model, terms = "HLVA") -->
<!-- p.HLVA <- plot(dat) -->
<!-- p.HLVA <- p.HLVA + -->
<!--   geom_point(data = all.studies.subjects, -->
<!--              aes(x = HLVA, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Health literacy (HLVA)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(c.)") -->
<!-- dat <- ggpredict(model, terms = "FACTOR3") -->
<!-- p.FACTOR3 <- plot(dat) -->
<!-- p.FACTOR3 <- p.FACTOR3 + -->
<!--   geom_point(data = all.studies.subjects, -->
<!--              aes(x = FACTOR3, y = mean.acc), size = 1.5, colour = "darkgrey", alpha = .2) + -->
<!--   geom_line(size = 1.5, colour = "red") + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Reading strategy (FACTOR3)") + ylab("Mean accuracy") + -->
<!--   ggtitle("(d.)") -->
<!-- dat <- ggpredict(model, terms = "NATIVE.LANGUAGE") -->
<!-- p.NATIVE.LANGUAGE <- plot(dat) -->
<!-- p.NATIVE.LANGUAGE <- p.NATIVE.LANGUAGE + -->
<!--   ylim(0, 1.1) + -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Native language") + ylab("Mean accuracy") + -->
<!--   ggtitle("(e.)") -->
<!-- p.AGE + p.SHIPLEY + p.HLVA + p.FACTOR3 + p.NATIVE.LANGUAGE + plot_layout(ncol = 3) -->
<!-- ``` -->
<!-- -   Coefficients estimates in the summary match what we see -->
<!-- -   Positive coefficients show upward slopes -->
<!-- -   Larger coefficients show steeper slopes -->
<!-- ## The language and style of reporting linear model results {.smaller} -->
<!-- > We fitted a linear model with mean comprehension accuracy as the outcome and, as predictors: vocabulary knowledge (Shipley), health literacy (HLVA), reading strategy (FACTOR3), age (years) and native language status. Our analysis indicated significant effects of all predictor variables. The model is significant overall, with $F(5, 555) = 81.09, p < .001$, and explains 42% of variance ($\text{adjusted } R^2 = 0.42$). The model estimates showed that the accuracy of comprehension increased with higher levels of participant vocabulary knowledge ($\beta = .007, t = 6.64, p <.001$), health literacy ($\beta = .024, t = 7.64, p <.001$), and reading strategy ($\beta = .005, t = 5.98, p = < .001$). Younger participants ($\beta = -0.003, t = -5.39, p <.001$) and native speakers of English as another language ($\beta = -.090, t = -6.37, p <.001$) tended to show lower levels of accuracy. -->
<!-- ## Look at what we do with the text {.smaller} -->
<!-- > We fitted a linear model with mean comprehension accuracy as the outcome and, as predictors: vocabulary knowledge (Shipley), health literacy (HLVA), reading strategy (FACTOR3), age (years) and native language status. Our analysis indicated significant effects of all predictor variables. The model is significant overall, with $F(5, 555) = 81.09, p < .001$, and explains 42% of variance ($\text{adjusted } R^2 = 0.42$). The model estimates showed that the accuracy of comprehension increased with higher levels of participant vocabulary knowledge ($\beta = .007, t = 6.64, p <.001$), health literacy ($\beta = .024, t = 7.64, p <.001$), and reading strategy ($\beta = .005, t = 5.98, p = < .001$). Younger participants ($\beta = -0.003, t = -5.39, p <.001$) and native speakers of English as another language ($\beta = -.090, t = -6.37, p <.001$) tended to show lower levels of accuracy. -->
<!-- 1.  Explain: the method (linear model); the outcome (accuracy) and the predictors -->
<!-- 2.  Report the model fit statistics overall ($F, R^2$) -->
<!-- 3.  Report the significant effects ($\beta, t, p$) and describe the nature of the effects -->
<!-- ## Let's take a break {background-color="aquamarine"} -->
<!-- ::: nonincremental -->
<!-- -   End of part 2 -->
<!-- ::: -->
<!-- ## Critically evaluating the results of analyses involving linear models -->
<!-- There are three levels of **uncertainty** when we look at sample data [@mcelreath2020] -- uncertainty over: -->
<!-- 1.  The nature of the expected change in outcome -->
<!-- 2.  The ways that expected changes might vary between individual participants or between groups of participants -->
<!-- 3.  The random ways that specific responses can be produced -->
<!-- ## Critically evaluating the results of analyses involving linear models -->
<!-- -   These uncertainties require us to carefully qualify the conclusions we draw from data analyses -->
<!-- -   This does not mean we should avoid *causal language* when we think that psychological processes cause the behaviours we examine [@Grosz2020] -->
<!-- -   But it *does mean* we can be careful to identify the limits in the evidence we analyse -->
<!-- ## Revision: As we move into thinking about the data analysis, we need to identify our assumptions -->
<!-- 1.  **validity**: that differences in knowledge or ability cause differences in test scores -->
<!-- 2.  **measurement**: that this is equally true across the different kinds of people we tested -->
<!-- 3.  **generalizability**: that the sample of people we recruited resembles the population -->
<!-- ## How do *you* do this work? -->
<!-- 1.  **validity** -->
<!-- -   We want to work with valid measures but *validity* requires explaining [@borsboom2004]: -->
<!-- a.  Does the thing exist in the world? -->
<!-- b.  Is variation in that thing be reflected in variation in our measurement? -->
<!-- -   What you can do: literature review $\rightarrow$ to identify your reasoning in answer to these questions -->
<!-- ## How do *you* do this work? -->
<!-- 2.  **measurement** -->
<!-- 3.  **generalizability** -->
<!-- -   It is most helpful to assume from the start that effects estimates will vary [@Gelman2015; @vasishth2021] -->
<!-- -   So then we ask ourselves: will this test work in the same way in different groups? -->
<!-- -   And we ask: how will these effects estimates vary across different groups -->
<!-- ## Why we need replication studies -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| echo: false -->
<!-- #| label: fig-scatterplot-facet-2 -->
<!-- #| fig-cap: "Scatterplot showing the potential association between accuracy of comprehension and vocabulary scores: Data from eight studies. Effects *will* vary between different samples so: expect the variation [@Gelman2015; @vasishth2021] >>> important to evaluating claims in the literature, and to evaluation of your own results" -->
<!-- #| fig-alt: "The figure presents a grid of scatterplots indicating the association between variables mean accuracy (on y-axis) and vocabulary (x-axis) scores. The points are shown in grey, and clustered such that higher vocabulary scores tend to be associated with higher accuracy scores. The trend is indicated by a thick red line. Each plot in the grid represents the pattern for data from one of eight studies. The scatter of points and the steepness if not the direction of the trend clearly varies between studies." -->
<!-- #| fig-width: 7.5 -->
<!-- #| fig-height: 7.5 -->
<!-- all.studies %>% -->
<!--   group_by(ResponseId) %>% -->
<!--   mutate(mean.acc = mean(response)) %>% -->
<!--   ungroup() %>% -->
<!--   distinct(ResponseId, .keep_all = TRUE) %>% -->
<!--   select(SHIPLEY, mean.acc, ResponseId, study) %>% -->
<!--   ggplot(aes(x = SHIPLEY, y = mean.acc)) + -->
<!--   geom_point(size = 2, alpha = .5, colour = "darkgrey") + -->
<!--   geom_smooth(size = 1.5, colour = "red", method = "lm", se = FALSE) + -->
<!--   xlim(0, 40) + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Vocabulary (Shipley)") + ylab("Mean accuracy") + -->
<!--   facet_wrap(~ study) -->
<!-- ``` -->
<!-- ## Why we need replication studies -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| echo: false -->
<!-- #| label: fig-scatterplot-facet-3 -->
<!-- #| fig-cap: "Effects will vary between samples *so* expect the variation [@Gelman2015; @vasishth2021] >>> ask what variation may result from *systematic differences between groups*" -->
<!-- #| fig-alt: "The figure presents a grid of scatterplots indicating the association between variables mean accuracy (on y-axis) and vocabulary (x-axis) scores. The points are shown in grey, and clustered such that higher vocabulary scores tend to be associated with higher accuracy scores. The trend is indicated by a thick red line. Each plot in the grid represents the pattern for data from one of eight studies. The scatter of points and the steepness if not the direction of the trend clearly varies between studies." -->
<!-- #| fig-width: 7.5 -->
<!-- #| fig-height: 7.5 -->
<!-- all.studies %>% -->
<!--   group_by(ResponseId) %>% -->
<!--   mutate(mean.acc = mean(response)) %>% -->
<!--   ungroup() %>% -->
<!--   distinct(ResponseId, .keep_all = TRUE) %>% -->
<!--   select(HLVA, mean.acc, ResponseId, study) %>% -->
<!--   ggplot(aes(x = HLVA, y = mean.acc)) + -->
<!--   geom_point(size = 2, alpha = .5, colour = "darkgrey") + -->
<!--   geom_smooth(size = 1.5, colour = "red", method = "lm", se = FALSE) + -->
<!--   xlim(0, 15) + -->
<!--   ylim(0, 1.1)+ -->
<!--   theme_bw() + -->
<!--   theme( -->
<!--     axis.text = element_text(size = rel(1.15)), -->
<!--     axis.title = element_text(size = rel(1.5)) -->
<!--   ) + -->
<!--   xlab("Health literacy (HLVA)") + ylab("Mean accuracy") + -->
<!--   facet_wrap(~ study) -->
<!-- ``` -->
<!-- ## Why we need to consider the generalizability of sample data -->
<!-- ```{r} -->
<!-- #| warning: false -->
<!-- #| echo: false -->
<!-- #| label: fig-factor-counts-grid -->
<!-- #| fig-cap: "Grid of plots showing the distribution of potential predictor variables" -->
<!-- #| fig-alt: "The figure presents a grid of plots indicating the distribution of (x-axis) scores on a range of predictor variables. The grid includes as predictors: age (years); gender; education, and ethnicity. The plots indicate: most participants are 20-40 years of age, some older; many more female than male participants, very few non-binary reported; many more participants with higher education than further, very few with secondary; and many White participants (ONS categories), far fewer Asian or Mixed or Black ethnicity participants." -->
<!-- #| fig-width: 12 -->
<!-- #| fig-height: 8 -->
<!-- p.age <- ggplot(data = all.studies.subjects, aes(x = AGE)) +  -->
<!--   geom_histogram(binwidth = 5) + -->
<!--   theme_bw() + -->
<!--   labs(x = "Age (years)", y = "frequency count")  -->
<!-- p.GENDER <- all.studies.subjects %>% -->
<!--   mutate(GENDER = fct_recode(GENDER,  -->
<!--             "Prefer-not-to-say" = "prefer-not-to-say"                  -->
<!--                              )) %>% -->
<!--   group_by(GENDER) %>% -->
<!--   summarise(count = n()) %>% -->
<!--   ungroup() %>% -->
<!--   mutate(GENDER = fct_reorder(GENDER, count)) %>% -->
<!--   ggplot(aes(y = GENDER, x = count)) + -->
<!--   geom_point(size = 3, aes(colour = GENDER)) + -->
<!--   theme_bw() +  -->
<!--   labs(y = "Gender", x = "frequency count")  -->
<!-- p.EDUCATION <- all.studies.subjects %>% -->
<!--   group_by(EDUCATION) %>% -->
<!--   summarise(count = n()) %>% -->
<!--   ungroup() %>% -->
<!--   mutate(EDUCATION = fct_reorder(EDUCATION, count)) %>% -->
<!--   ggplot(aes(y = EDUCATION, x = count)) + -->
<!--   geom_point(size = 3, aes(colour = EDUCATION)) + -->
<!--   theme_bw() +  -->
<!--   labs(y = "Education", x = "frequency count")  -->
<!-- p.ETHNICITY <- all.studies.subjects %>% -->
<!--   group_by(ETHNICITY) %>% -->
<!--   summarise(count = n()) %>% -->
<!--   ungroup() %>% -->
<!--   mutate(ETHNICITY = fct_reorder(ETHNICITY, count)) %>% -->
<!--   ggplot(aes(y = ETHNICITY, x = count)) + -->
<!--   geom_point(size = 3, aes(colour = ETHNICITY)) + -->
<!--   theme_bw() +  -->
<!--   labs(y = "Education", x = "frequency count") -->
<!-- p.age + p.GENDER + p.EDUCATION + p.ETHNICITY +  -->
<!--   plot_layout(ncol = 2) -->
<!-- ``` -->
<!-- ## Convenience samples are common in Psychology -->
<!-- -   We test who we can -- convenience sampling -- and who we can test has an impact on the quality of evidence [@bornstein2013] -->
<!-- -   If age, ethnicity or gender are not balanced $\rightarrow$ does this matter to your research question? -->
<!-- -   If samples are limited in size $\rightarrow$ how does that affect our uncertainty over effects estimates? -->
<!-- ## Let's take a break {background-color="aquamarine"} -->
<!-- ::: nonincremental -->
<!-- -   End of part 3 -->
<!-- ::: -->
<!-- ## The linear model is very flexible, powerful and general -->
<!-- -   Most introductory statistics classes teach each statistical test *as if* they are independent -->
<!-- ::: callout-tip -->
<!-- Most common statistical tests are special cases of linear models, or are close approximations -->
<!-- ::: -->
<!-- ## The t-test as linear model -->
<!-- $y_i = \beta_0 + \beta_1X$ -->
<!-- -   If you have two groups, with a variable `X` coding for group membership -->
<!-- -   Then the mean outcome for one group $= \beta_0$ -->
<!-- -   The estimate of the slope $\beta_1$ tells about the average difference between groups -->
<!-- -   And we can code the model like this: `lm(y ~ group)` -->
<!-- ## ANOVA as linear model {.smaller} -->
<!-- $y_i = \beta_0 + \beta_1X + \beta_2Z + \beta_3XZ$ -->
<!-- -   If you have a 2 x 2 factorial design, with two factors `factor.1, factor.2`, and a dataset with variables `X, Z` coding for group membership -->
<!-- -   Then the mean outcome for baseline conditions $= \beta_0$ -->
<!-- -   The estimates of the slopes $\beta_1, \beta_2$ tells about the average difference between groups -->
<!-- -   The estimate of the slope $\beta_3$ tells us about the interaction -->
<!-- -   And we can code the model like this: `lm(y ~ factor.1*factor.2)` -->
<!-- -   Or this `Anova(aov(y ~ factor.1*factor.2, data), type='II')` -->
<!-- ## ANOVA as linear model {.smaller} -->
<!-- -   In general, the psychological literature is full of ANOVA -->
<!-- -   But the field is moving away from ANOVA towards mixed-effects models -->
<!-- ::: callout-tip -->
<!-- We have to make choices in teaching and, here, we are choosing to focus on a powerful, flexible, and generally applicable method we can explain *in depth*: linear models -->
<!-- -   Our aim is for students to better understand how to use a general approach -->
<!-- ::: -->
<!-- ## Extensions to the linear model -->
<!-- $outcome ~ predictors + error$ -->
<!-- -   `outcome` can generalize to analyse data that are not metric, do not come from normal distributions -->
<!-- -   `predictors` can be curvilinear, categorical, involve interactions -->
<!-- -   `error` can be independent; can be non-independent -->
<!-- ## Look ahead: extensions to the linear model -->
<!-- -   What if the outcome measurement data cannot be understood to be metric or to come from a normal probability distribution? -->
<!-- ## Extensions to the linear model -- binary or dichotomous outcomes -->
<!-- 1.  Binary outcomes are very common in Psychology: yes or no; correct or incorrect; left or right visual field etc. -->
<!-- 2.  The change in coding is e.g. `glm(ratings ~ predictors, family = "binomial")` -->
<!-- ## Extensions to the linear model -- ordinal outcomes -->
<!-- 1.  Likert scale or ratings data are best analysed using ordinal models [@liddell2018analyzing] -->
<!-- 2.  The change in coding [see @christensen2022] is e.g. `clm(ratings ~ predictors)` -->
<!-- ## Extensions to the linear model -- non-independence of observations -->
<!-- 1.  Much -- maybe most -- psychological data are collected in ways that guarantee the non-independence of observations -->
<!-- -   We test children in classes, patients in clinics, individuals in regions -->
<!-- -   We test participants in multiple trials in an experiment, recording responses to multiple stimuli -->
<!-- 2.  These data should be analysed using **linear mixed-effects models** [@meteyard2020best] -->
<!-- ## General advice -->
<!-- An old saying goes:  -->
<!-- >All models are wrong but some are useful -->
<!-- (attributed to George Box). -->
<!-- ::: callout-tip -->
<!-- - Sometimes, it can be useful to adopt a simpler approach as a way to approximate *get closer to* better methods -->
<!-- - Box also advises "Since all models are wrong the scientist must be alert to what is importantly wrong. It is inappropriate to be concerned about mice when there are tigers abroad." -->
<!-- - Here, we focus on validity, measurement, generalizability and *critical thinking* -->
<!-- ::: -->
<!-- ## Summary -->
<!-- - Linear models are a very general, flexible, and powerful analysis method -->
<!-- - We can use assuming that prediction outcomes (residuals) are normally distributed -->
<!-- - With potentially multiple predictor variables -->
<!-- ## Summary -->
<!-- - Closing the loop: when we plan an analysis we should try to use contextual information -- theory and measurement understanding -- to specify our model -->
<!-- - Closing the loop: when we critically evaluate our or others' findings, we should consider validity, measurement, and generalizability -->
<!-- ## Summary -->
<!-- - When we report an analysis, we should report: -->
<!-- 1. Explain what I did, specifying the method (linear model), the outcome variable (accuracy) and the predictor variables (health literacy, reading strategy, reading skill and vocabulary) -->
<!-- 2. Report the model fit statistics overall ($F, R^2$) -->
<!-- 3. Report the significant effects ($\beta, t, p$) and describe the nature of the effects (does the outcome increase or decrease?) -->


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
          // target, if specified
          link.setAttribute("target", "_blank");
          // default icon
          link.classList.add("external");
      }
    }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./lm-intro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to the linear model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./report-preface.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">The research report assignment: Outline introduction</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>